### **Цель занятия:**  
Научить участников настраивать и управлять идентификацией пользователей, ролями и доступом в Yandex Cloud с использованием IAM, сервисных аккаунтов, групп и политик безопасности.

---

### **Целевая аудитория:**  
Системные администраторы, DevOps-инженеры, cloud-архитекторы, начинающие специалисты по облачной безопасности.

---

### **Продолжительность:**  
2,5 часа (150 минут)

---

### **Формат:**  
Онлайн или очно, с демонстрацией экрана и практическими заданиями в личных аккаунтах участников.

---

## **План занятия**

---

### **1. Введение (15 мин)**

- Приветствие, представление темы.
- Зачем нужно управление идентификацией и доступом (IAM)?
- Обзор архитектуры управления доступом в Yandex Cloud:
  - Облака (Clouds)
  - Каталоги (Folders)
  - Пользователи, группы, сервисные аккаунты
  - Роли и политики доступа
- Обзор ключевых компонентов:
  - Yandex ID
  - IAM (Identity and Access Management)
  - Сессионные токены, OAuth, API-ключи

---

### **2. Теория: Основы IAM в Yandex Cloud (20 мин)**

- **Пользователи и группы**
  - Как добавлять пользователей (через Yandex ID)
  - Создание групп и управление членством
- **Сервисные аккаунты**
  - Что такое сервисный аккаунт?
  - Когда использовать (вместо пользователей)?
- **Роли и права**
  - Иерархия ролей: `viewer`, `editor`, `admin`, `resource-manager.editor` и др.
  - Наследование прав (облако → каталог → ресурс)
  - Кастомные роли (обзор)
- **Политики доступа**
  - Принцип наименьших привилегий
  - Примеры политик (JSON)

> **Демонстрация:** Показ интерфейса IAM в консоли Yandex Cloud.

---

### **3. Демонстрация: Настройка управления доступом (30 мин)**

**Сценарий:**
1. Создание нового каталога.
2. Добавление пользователя (по email) и назначение роли `editor`.
3. Создание группы "dev-team", добавление пользователей.
4. Назначение роли группе на уровне каталога.
5. Создание сервисного аккаунта для виртуальной машины.
6. Назначение ему роли `compute.viewer`.
7. Генерация статического ключа для сервисного аккаунта (для CLI/API).
8. Проверка доступа через CLI (кратко).

> **Инструменты:** Yandex Cloud Console, CLI (yc)

---

### **4. Практическая часть (60 мин)**

#### **Задание 1: Настройка пользователей и групп**
- Создайте каталог `security-lab`.
- Добавьте двух пользователей (можно использовать свои тестовые email).
- Создайте группу `cloud-admins`, добавьте одного пользователя.
- Назначьте группе роль `admin` в каталоге.

#### **Задание 2: Работа с сервисными аккаунтами**
- Создайте сервисный аккаунт `backup-worker`.
- Назначьте ему роль `storage.editor`.
- Сгенерируйте статический ключ и сохраните его (для последующего использования).

#### **Задание 3: Применение принципа минимальных привилегий**
- Создайте ещё один сервисный аккаунт `monitoring-agent`.
- Назначьте только `monitoring.viewer`.
- Попробуйте через CLI (или визуально) убедиться, что он не может читать объекты в Object Storage.

> **Поддержка:** Инструктор помогает участникам, проверяет выполнение.

---

### **5. Разбор типичных ошибок и лучших практик (15 мин)**

- Распространённые ошибки:
  - Назначение `admin` слишком широко
  - Использование пользовательских аккаунтов вместо сервисных
  - Отсутствие групп — трудно масштабировать
- Лучшие практики:
  - Использовать группы для управления доступом
  - Сервисные аккаунты для автоматизации
  - Регулярный аудит прав (через IAM audit или визуально)
  - Использование кастомных ролей при необходимости
- Интеграция с внешними системами (SAML, OAuth — кратко)

---

### **6. Заключение и Q&A (10 мин)**

- Краткий итог: что изучили?
- Где применять эти знания (CI/CD, безопасность, мультикомандная работа)?
- Ответы на вопросы.
- Рекомендации для дальнейшего изучения:
  - Документация Yandex Cloud IAM
  - Учебные модули в Yandex Cloud Education
  - Практика: настройка доступа для реального проекта

---

### **Требования к участникам:**

- Аккаунт в Yandex Cloud (можно бесплатный с кредитом).
- Установленный Yandex Cloud CLI (`yc`).
- Доступ к email для добавления в группы (можно использовать временные).
- Базовое понимание облачных технологий.

---

### **Дополнительно (по желанию):**

- **Расширенное задание:** Настроить автоматическое создание сервисного аккаунта через Terraform.
- **Кейс:** Имитация увольнения сотрудника — как быстро отозвать доступ?

---

### **Оценка эффективности:**

- Опрос в конце: «Что было самым сложным?»
- Мини-тест из 5 вопросов (по желанию)
- Обратная связь от участников

---

## **Домашнее задание**  
### **Тема:** Проектирование пользовательской иерархии и модели доступа в Yandex Cloud

---

### **Цель задания:**  
Научиться проектировать безопасную и масштабируемую структуру управления доступом (IAM) в облаке на основе реального бизнес-сценария.

---

### **Продолжительность выполнения:**  
1–2 часа (рекомендуется выполнить в течение 3 дней после занятия)

---

### **Формат сдачи:**  
Письменный отчёт в формате **PDF или Google Doc**, объёмом 1–2 страницы.  
Может включать схемы (текстовые описания или рисунки), таблицы, JSON-фрагменты политик.

---

## **Задание**

Представьте, что вы — **Cloud Security Architect** в компании **"TechNova"**, которая переходит в Yandex Cloud. Компания состоит из нескольких подразделений:

| Подразделение | Описание |
|--------------|--------|
| **Разработка (Dev)** | 10 инженеров, работают с виртуальными машинами, контейнерами, CI/CD |
| **DevOps** | 4 инженера, управляют инфраструктурой, сетями, мониторингом |
| **Аналитика данных (Data Team)** | 5 аналитиков, работают с Yandex Object Storage и Managed ClickHouse |
| **HR и Финансы** | 6 человек, нужен доступ к отчётам по затратам (но не к техническим ресурсам) |
| **Администрация (Admin)** | 2 человека, полный доступ ко всем каталогам |

---

### **Ваша задача:**

1. **Спроектируйте иерархию ресурсов в Yandex Cloud:**
   - Определите структуру **облака (Cloud)** и **каталогов (Folders)**.
   - Предложите, сколько каталогов нужно и как их назвать (например: `dev`, `data`, `infra`, `finance` и т.д.).
   - Обоснуйте выбор (почему такая структура?).

2. **Создайте модель управления доступом (IAM):**
   - Определите **группы пользователей** (например: `dev-team`, `devops-admins`, `data-analysts`, `finance-viewers`, `cloud-admins`).
   - Для каждой группы:
     - Назначьте **подходящие роли** на уровне облака и/или каталогов.
     - Укажите, в каких каталогах они имеют доступ.
     - Обоснуйте выбор ролей (принцип минимальных привилегий).
   - Пример:
     ```
     Группа: devops-admins
     Роли: 
       - в каталоге infra: editor
       - в каталоге dev: viewer
       - в облаке: resource-manager.clouds.member
     ```

3. **Сервисные аккаунты:**
   - Предложите **два примера** использования сервисных аккаунтов (например, для бэкапов, CI/CD).
   - Укажите:
     - Имя сервисного аккаунта
     - Каталог, где он создан
     - Назначенную роль
     - Назначение (для чего используется)

4. **Безопасность и аудит:**
   - Как вы будете следить за изменениями в доступе?
   - Какие меры предпримете, если сотрудник уволится?
   - Что вы порекомендуете для регулярного аудита прав?

---

### **Дополнительно (по желанию — бонусные баллы):**

- Нарисуйте схему (в текстовом виде или через draw.io / mermaid) иерархии:  
  **Облако → Каталоги → Группы → Роли**
- Напишите пример **кастомной роли** (через JSON) для аналитика, который может читать только определённые бакеты в Object Storage.
- Предложите, как интегрировать **внешнюю систему управления доступом** (например, через SAML или LDAP), если компания использует корпоративный Active Directory.

---

## **Критерии оценки:**

| Критерий | Баллы |
|--------|-------|
| Логичная структура облака и каталогов | 20% |
| Корректное использование групп и ролей | 30% |
| Соблюдение принципа минимальных привилегий | 20% |
| Уместное использование сервисных аккаунтов | 15% |
| Рекомендации по безопасности и аудиту | 15% |
| Дополнительные элементы (схема, кастомные роли и т.д.) | +10% |

---

## **Пример оформления (фрагмент):**

> **Структура каталогов:**
> - `cloud-root` (облако)
>   - `dev` — для разработки
>   - `data` — для хранения и анализа данных
>   - `infra` — сетевая и системная инфраструктура
>   - `finance` — финансовые отчёты и cost management
>
> **Группы и роли:**
> - Группа: `data-analysts`
>   - Доступ: каталог `data`
>   - Роли: `storage.viewer`, `managed-clickhouse.user`
>   - Обоснование: аналитикам не нужен доступ к управлению инфраструктурой, только к данным.
>
> **Сервисный аккаунт:**
> - Имя: `ci-runner-sa`
> - Каталог: `dev`
> - Роль: `editor`
> - Назначение: запуск сборок в CI/CD-пайплайне

---

## **Ресурсы для выполнения:**

- [Документация IAM в Yandex Cloud](https://cloud.yandex.ru/docs/iam/)
- [Управление ресурсами](https://yandex.cloud/ru/docs/resource-manager/)
- [Сервисные аккаунты](https://cloud.yandex.ru/docs/iam/concepts/users/service-accounts)
- [# Identity Hub](https://yandex.cloud/ru/docs/organization/)

---

### **Срок сдачи:**  
Через 3 дня после занятия.

---

Это домашнее задание помогает закрепить навыки проектирования IAM-архитектуры, развивает системное мышление и готовит к реальным задачам в облачных проектах.