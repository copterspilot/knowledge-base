## üìò –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –ª–æ–≥–æ–≤?

–ö–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ª–æ–≥, –æ–Ω —á–∞—Å—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç **–º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é**:
```text
2025-04-05 10:30:15 ERROR Failed to process request from 192.168.10.45
```

–ù–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç—Ç–æ–≥–æ **–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ**. –•–æ—á–µ—Ç—Å—è –∑–Ω–∞—Ç—å:
- –ö—Ç–æ —ç—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?
- –í –∫–∞–∫–æ–º —Ä–µ–≥–∏–æ–Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è IP?
- –ö–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª –∑–∞–ø—Ä–æ—Å?
- –ö–∞–∫–æ–π `trace_id` —É —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞?

**–û–±–æ–≥–∞—â–µ–Ω–∏–µ –ª–æ–≥–æ–≤** –¥–æ–±–∞–≤–ª—è–µ—Ç —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:
```json
{
  "timestamp": "2025-04-05T10:30:15Z",
  "level": "ERROR",
  "message": "Failed to process request",
  "client_ip": "192.168.10.45",
  "user_id": "usr-789",
  "username": "ivan_petrov",
  "region": "–ú–æ—Å–∫–≤–∞",
  "service": "payment-service",
  "version": "v1.8.2",
  "trace_id": "abc123xyz",
  "request_id": "req-555",
  "environment": "prod"
}
```

–¢–µ–ø–µ—Ä—å –ª–æ–≥ —Å—Ç–∞–ª **—Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º** ‚Äî –µ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–∏—Å–∫–∞, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –¥—Ä—É–≥–∏–º —Å–∏—Å—Ç–µ–º–∞–º.

---

## üß© –ó–∞—á–µ–º –Ω—É–∂–Ω–æ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –ª–æ–≥–æ–≤?

| –ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ –æ–±–æ–≥–∞—â–µ–Ω–∏—è          | –†–µ—à–µ–Ω–∏–µ —Å –æ–±–æ–≥–∞—â–µ–Ω–∏–µ–º                                 |
| -------------------------------- | ----------------------------------------------------- |
| –õ–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ IP           | –î–æ–±–∞–≤–ª—è–µ–º: —Ä–µ–≥–∏–æ–Ω, —Å—Ç—Ä–∞–Ω—É, —Ç–∏–ø –∫–ª–∏–µ–Ω—Ç–∞                |
| –ù–µ—Ç —Å–≤—è–∑–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º        | –î–æ–±–∞–≤–ª—è–µ–º: user_id, username, —Ä–æ–ª—å                    |
| –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –≥–¥–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å–æ–±—ã—Ç–∏–µ | –î–æ–±–∞–≤–ª—è–µ–º: service, pod, node, namespace              |
| –ù–µ–ª—å–∑—è —Å–≤—è–∑–∞—Ç—å —Å —Ç—Ä–µ–π—Å–æ–º         | –î–æ–±–∞–≤–ª—è–µ–º: trace_id, span_id                          |
| –¢—Ä—É–¥–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤ –¥–∞—à–±–æ—Ä–¥–µ  | –õ–æ–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω ‚Äî –ª–µ–≥–∫–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å |

---

## üîß –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–±–æ–≥–∞—â–µ–Ω–∏–µ?

–ü—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å **–Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–ø–∞—Ö**:

### 1. **–ù–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ª—É—á—à–∏–π —Å–ø–æ—Å–æ–±)**
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–∞–º–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç:
  ```java
  logger.error("Payment failed", 
    MDC.put("user_id", userId), 
    MDC.put("trace_id", traceId));
  ```

### 2. **–ù–∞ —É—Ä–æ–≤–Ω–µ –∞–≥–µ–Ω—Ç–∞ —Å–±–æ—Ä–∞ (Fluent Bit, Fluentd, Logstash)**
- –ê–≥–µ–Ω—Ç "–æ–±–æ–≥–∞—â–∞–µ—Ç" –ª–æ–≥–∏ –ø—Ä–∏ —Å–±–æ—Ä–µ:
  - –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–≥–∏: `env=prod`, `region=ru-central1`
  - –†–∞–∑–±–∏–≤–∞–µ—Ç –ø–æ–ª—è: –ø–∞—Ä—Å–∏—Ç `user-agent` ‚Üí –û–°, –±—Ä–∞—É–∑–µ—Ä
  - –û–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º: IP ‚Üí —Ä–µ–≥–∏–æ–Ω

**–ü—Ä–∏–º–µ—Ä –≤ Fluent Bit:**
```ini
[FILTER]
    Name                record_modifier
    Match               *
    Record              environment prod
    Record              cluster my-k8s-cluster

[FILTER]
    Name                geoip2
    Match               *
    Database            /etc/geoip/GeoLite2-City.mmdb
    Key_Name            client_ip
    Record              country_name
    Record              city
```

### 3. **–ù–∞ —É—Ä–æ–≤–Ω–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞/–ø–æ–∏—Å–∫–∞ (Elasticsearch, Grafana, SIEM)**
- –ü—Ä–∞–≤–∏–ª–∞ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –≤ Kibana, Splunk, Sentinel:
  - –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ IP —Å AD-–≥—Ä—É–ø–ø–∞–º–∏
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

---

## üì¶ –ü—Ä–∏–º–µ—Ä—ã –æ–±–æ–≥–∞—â–µ–Ω–∏—è

| –ò—Å—Ö–æ–¥–Ω—ã–π –ª–æ–≥ | –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|-------------|---------------|----------|
| `Login failed for IP=203.0.113.10` | –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è, ASN, —Å—Ç—Ä–∞–Ω–∞ | `country: "Japan", asn: "NTT Communications"` |
| `Order created by user_123` | –ò–º—è, email, —Ä–æ–ª—å | `username: "–ê–Ω–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞", role: "admin"` |
| `Pod crashed` | namespace, node, owner | `namespace: "finance", owner: "team-b"` |
| `HTTP 500` | trace_id, request_id | –°–≤—è–∑—å —Å —Ç—Ä–µ–π—Å–æ–º –≤ Jaeger/Tempo |
| `Deployment applied` | git_commit, author | `commit: abc123, author: dev@company.ru` |

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –ª–æ–≥–æ–≤

| –ü–ª—é—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|---------|
| **–ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** | –ù–µ –Ω—É–∂–Ω–æ "–ø—Ä—ã–≥–∞—Ç—å" –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏ |
| **–£–ª—É—á—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | –í–∏–¥–Ω–æ, –∫—Ç–æ, –æ—Ç–∫—É–¥–∞ –∏ —á—Ç–æ –¥–µ–ª–∞–ª |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ SLO/SLI** | –ú–æ–∂–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —Ä–µ–≥–∏–æ–Ω—É |
| **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 152-–§–ó** | –õ–æ–≥–∏ —Å –ü–î–Ω —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∞—É–¥–∏—Ä—É–µ–º—ã–º–∏ |
| **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫** | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `user_id`, `service`, `region` |

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

| –†–∏—Å–∫ | –ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å |
|------|--------------|
| **–£—Ç–µ—á–∫–∞ –ü–î–Ω** | –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å email, –§–ò–û; –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—é |
| **–†–æ—Å—Ç –æ–±—ä—ë–º–∞ –ª–æ–≥–æ–≤** | –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è |
| **–ó–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–∏** | –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (GeoIP, AD) |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏** | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –æ–±–æ–≥–∞—â–µ–Ω–∏—è |

---

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –ª–æ–≥–æ–≤

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–æ–≥–∞—â–µ–Ω–∏—è |
|----------|------------------------|
| **Fluent Bit / Fluentd** | –¢–µ–≥–∏, geoip, record_modifier, Kubernetes metadata |
| **Logstash** | –§–∏–ª—å—Ç—Ä—ã: geoip, mutate, lookup |
| **OpenTelemetry Collector** | –û–±–æ–≥–∞—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ processors |
| **Grafana Loki + Promtail** | Pipeline stages: regex, label, json, geoip |
| **Elasticsearch Ingest Pipelines** | –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã: enrich, grok, geoip |
| **Yandex Cloud Logging** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: folder_id, resource, labels |

---

## üìå –ü—Ä–∏–º–µ—Ä: –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –≤ Kubernetes

```yaml
# Fluent Bit: –¥–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∞
[FILTER]
    Name                kubernetes
    Match               kube.*
    Kube_URL            https://kubernetes.default.svc:443
    Kube_CA_File        /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    Kube_Token_File     /var/run/secrets/kubernetes.io/serviceaccount/token
    Merge_Log           On
```

–¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç:
```json
{
  "pod_name": "auth-service-7d8f9c",
  "namespace": "prod",
  "container_name": "main",
  "labels": { "app": "auth", "version": "v2" }
}
```

---

## ‚úÖ –í—ã–≤–æ–¥

**–û–±–æ–≥–∞—â–µ–Ω–∏–µ –ª–æ–≥–æ–≤ ‚Äî —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —ç—Ç–∞–ø** –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏.

> üîë **–õ—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:**  
> –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç **–∫–∞–∫ –º–æ–∂–Ω–æ –±–ª–∏–∂–µ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É** (–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏), –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≥–µ–Ω—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Ç–µ–≥–æ–≤.

–ë–µ–∑ –æ–±–æ–≥–∞—â–µ–Ω–∏—è ‚Äî –ª–æ–≥–∏ **–º–∞–ª–æ–ø–æ–ª–µ–∑–Ω—ã**.  
–° –æ–±–æ–≥–∞—â–µ–Ω–∏–µ–º ‚Äî –æ–Ω–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è **–æ—Å–Ω–æ–≤–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞**.

---
