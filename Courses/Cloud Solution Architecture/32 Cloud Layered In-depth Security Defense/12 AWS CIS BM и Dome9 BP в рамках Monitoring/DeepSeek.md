### **Сравнение AWS CIS Benchmark и Dome9 Best Practices в рамках Monitoring**

---

#### **1. Ключевые концептуальные различия**

| **Аспект**               | **AWS CIS Benchmark**                              | **Dome9 BP**                                  |
|--------------------------|--------------------------------------------------|----------------------------------------------|
| **Подход**              | Реактивный контроль (чек-лист)                  | Проактивный мониторинг с ML-аналитикой       |
| **Глубина покрытия**    | 12 базовых контрольных точек                    | 50+ специализированных датчиков              |
| **Частота обновления**  | Ежегодные обновления стандарта                  | Еженедельное обновление правил мониторинга   |

---

#### **2. Конкретные требования к мониторингу**

| **Контрольная точка**               | **CIS Benchmark**                              | **Dome9 BP**                                  |
|-------------------------------------|-----------------------------------------------|-----------------------------------------------|
| **Мониторинг VPC Flow Logs**       | Рекомендует включение (раздел 4.3)           | Автоматически активирует + анализирует аномалии трафика |
| **CloudWatch Alarms**              | Требует базовых алертов (раздел 4.8)         | Интеллектуальные алерты с динамическими порогами |
| **Конфигурация GuardDuty**         | Рекомендует активацию (раздел 4.7)           | Автоматическая настройка + кастомизация правил |
| **Мониторинг изменений конфигурации** | Ручная проверка через AWS Config            | Непрерывный контроль дрейфа конфигураций      |

---

#### **3. Техническая реализация**

**AWS CIS Benchmark:**
```bash
# Ручная проверка Flow Logs (CIS 4.3)
aws ec2 describe-flow-logs --query 'FlowLogs[].ResourceId'

# Проверка CloudWatch (CIS 4.8)
aws cloudwatch describe-alarms --query 'MetricAlarms[].AlarmName'
```
**Ограничения:**
- Нет автоматического создания алертов
- Требует ручного анализа метрик

**Dome9 BP:**
```python
# Автоматизированный workflow
if anomalous_traffic_detected():
    trigger_incident_response()
    isolate_compromised_instance()
    
if config_drift_found():
    auto_remediate_from_golden_image()
```
**Преимущества:**
- Интеграция с 20+ источниками данных
- Предсказательная аналитика на основе ML

---

#### **4. Соответствие стандартам**

| **Требование**               | **CIS** | **Dome9** |
|------------------------------|---------|-----------|
| Непрерывный мониторинг       | ❌       | ✅         |
| ML-детекция аномалий        | ❌       | ✅         |
| Автоматическое реагирование  | ❌       | ✅         |
| Кастомизация правил         | ❌       | ✅         |

---

#### **5. Практические кейсы**

**CIS Benchmark:**
- Обнаружил отсутствие мониторинга неиспользуемых security groups
- Требовал ручной настройки CloudWatch

**Dome9 BP:**
1. Автоматически выявил подозрительный исходящий трафик
2. Инициировал изоляцию EC2-инстанса
3. Обновил NACL правила для блокировки C2-сервера

---

#### **6. Критерии выбора**

**Для стартапов:**
- CIS + AWS Native Tools (до 50 ресурсов)
- Ручная настройка CloudWatch

**Для предприятий:**
- Dome9 с возможностями:
  - Кросс-аккаунтовый мониторинг
  - Поведенческий анализ
  - Автоматизированные playbook'и

**Статистика:**
Dome9 сокращает MTTR с 4 часов (ручной процесс) до 12 минут.

```
[Эволюция мониторинга]
  CIS: Сбор данных → Ручной анализ → Реагирование
  Dome9: Обнаружение → Автоанализ → Автолечение
```

**Рекомендация:** Комбинировать CIS как базовый стандарт с Dome9 для операционного контроля.