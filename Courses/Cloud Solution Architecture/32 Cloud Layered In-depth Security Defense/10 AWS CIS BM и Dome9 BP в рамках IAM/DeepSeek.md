### **Сравнение AWS CIS Benchmark и Dome9 Best Practices в рамках IAM**

---

#### **1. Ключевые отличия в подходах**

| **Аспект**               | **AWS CIS Benchmark**                                      | **Dome9 Best Practices**                              |
|--------------------------|----------------------------------------------------------|------------------------------------------------------|
| **Философия**           | Реактивный контроль (чек-лист для аудита)                | Проактивная защита (непрерывный мониторинг + автоматическое исправление) |
| **Глубина проверок**    | Базовые требования (Level 1)                             | Расширенные политики (включая кастомные правила)     |
| **Инструментарий**      | AWS CLI + ручные проверки                                | Графический интерфейс + API-интеграции              |

---

#### **2. Конкретные проверки IAM**

| **Контрольная точка**                     | **CIS Benchmark**                                      | **Dome9 BP**                                         |
|-------------------------------------------|-------------------------------------------------------|-----------------------------------------------------|
| **MFA для root-аккаунта**                | Ручная проверка через CLI: `aws iam get-account-summary` | Автоматическое обнаружение и оповещение при отключении |
| **Неиспользуемые IAM-ключи**             | Рекомендация удалять ключи старше 90 дней             | Автоматическая ротация/блокировка через 45 дней     |
| **Избыточные разрешения**                | Проверка политик с `"Effect": "Allow", "Action": "*"` | Графическая карта прав с рекомендациями по оптимизации |
| **Условия IAM**                          | Базовые проверки IP-ограничений                       | Расширенный анализ: геолокация, временные окна      |
| **Сервисные аккаунты**                   | Проверка активных ключей                              | Автоматическое обнаружение ключей в публичных репозиториях |

---

#### **3. Техническая реализация**

**AWS CIS Benchmark:**
```bash
# Пример ручной проверки MFA (CIS 1.2)
aws iam list-virtual-mfa-devices
# Проверка сложности пароля (CIS 1.5)
aws iam get-account-password-policy
```
**Ограничения:**  
- Нет автоматического исправления  
- Только snapshot-проверки  

**Dome9 BP:**  
```python
# Автоматический workflow Dome9
if iam_policy_contains("*"):
    downgrade_to_least_privilege()
    notify_owner_via_slack()
```
**Преимущества:**  
- Интеграция с AWS Organizations  
- Визуализация цепочек прав  

---

#### **4. Соответствие стандартам**

| **Требование IAM**         | **CIS** | **Dome9** |
|----------------------------|---------|-----------|
| MFA для всех пользователей | ✅       | ✅ (с принудительным включением) |
| Запрет *:* в политиках     | ✅       | ✅ + автоматическое исправление |
| Регулярная ротация ключей  | ❌ (только рекомендация) | ✅ (автоматическая) |
| Анализ рисков делегирования | ❌      | ✅         |

---

#### **5. Практические кейсы**

**CIS Benchmark:**  
- Обнаружил, что 3 пользователя имеют `AdministratorAccess`  
- Требует ручного исправления через консоль  

**Dome9 BP:**  
1. Автоматически понизил права до `ReadOnlyAccess`  
2. Отправил запрос на утверждение в ServiceNow  
3. Закрыл временные исключения через 24 часа  

---

#### **6. Рекомендации**

**Для стартапов:**  
- CIS Benchmark + AWS Config Rules (бесплатный вариант)  

**Для предприятий:**  
- Dome9 + AWS Organizations:  
  - Единое управление правами  
  - Автоматическая remediation  
  - Отчеты для аудиторов  

**Тренд 2024:**  
Dome9 сокращает время реагирования на IAM-угрозы с 72 часов (ручные проверки CIS) до 15 минут.  

``` 
[Эволюция IAM-безопасности]
  CIS: Обнаружение → Ручное исправление (дни)
  Dome9: Обнаружение → Автоисправление (минуты)
```