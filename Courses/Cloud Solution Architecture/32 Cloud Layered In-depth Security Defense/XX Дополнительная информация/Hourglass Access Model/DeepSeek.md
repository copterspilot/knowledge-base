### **Модель доступа "Песочные часы" (Hourglass Model) в информационной безопасности**

---

#### **Определение и концепция**
Модель "Песочные часы" — это архитектурный подход к управлению доступом, где:
- **Центральный узкий сегмент** (узкое горлышко) — единый стандартизированный протокол/интерфейс  
- **Расширяющиеся уровни** — разнородные системы на входе и выходе  

**Аналогия**:  
Как в песочных часах песок проходит через узкое горлышко, так и в этой модели все запросы проходят через строго контролируемый центральный механизм.

---

#### **Структура модели**
``` 
[Разнородные системы]  
       ↓  
[Унифицированный интерфейс доступа] ← Центр контроля политик  
       ↓  
[Разнородные ресурсы]
```

**Ключевые компоненты**:
1. **Верхний уровень**: Множество клиентов (пользователи, устройства, сервисы)  
2. **Центральное звено**:  
   - Единый протокол аутентификации (например, OAuth 2.0)  
   - Централизованный PDP (Policy Decision Point)  
3. **Нижний уровень**: Разнородные защищаемые ресурсы (облачные хранилища, API, базы данных)  

---

#### **Преимущества модели**
| **Характеристика**       | **Пример реализации**                          |
|--------------------------|-----------------------------------------------|
| **Стандартизация**       | Все запросы проходят через единый API-шлюз    |
| **Гибкость**             | Поддержка legacy-систем через адаптеры        |
| **Масштабируемость**     | Добавление новых ресурсов не требует изменений ядра |
| **Безопасность**         | Централизованный аудит и контроль доступа     |

---

#### **Применение в облачных системах (на примере Yandex Cloud)**
1. **Входные системы**:  
   - Разные клиенты: мобильные приложения, IoT-устройства, внешние API  
2. **Центральное звено**:  
   - **Yandex Identity and Access Management (IAM)**  
   - **API Gateway** с авторизацией через OAuth-токены  
3. **Ресурсы**:  
   - Object Storage, Managed Databases, Kubernetes-кластеры  

**Пример потока запроса**:
```python
# 1. Клиент получает токен в IAM
token = yc_iam.get_token(client_id, secret)

# 2. Запрос проходит через API Gateway
response = api_gateway.request(
    method="GET",
    url="/storage/data",
    headers={"Authorization": f"Bearer {token}"}
)

# 3. PDP проверяет политики:
if check_policy(token, "read:storage"):
    return storage.get_data()
```

---

#### **Сравнение с другими моделями**
| **Модель**            | **Песочные часы**               | **Монолит**                    | **Микросервисы**             |
|-----------------------|--------------------------------|-------------------------------|-----------------------------|
| **Гибкость**         | Высокая                       | Низкая                        | Очень высокая               |
| **Безопасность**     | Централизованный контроль      | Единая точка отказа           | Децентрализованные риски    |
| **Сложность администрирования** | Средняя          | Низкая                        | Очень высокая               |

---

#### **Best Practices для внедрения**
1. **Выбор стандартного протокола**:  
   - OAuth 2.0 + OpenID Connect для аутентификации  
   - GraphQL или REST для API-шлюза  
2. **Реализация PDP**:  
   - Использование Rego (язык политик Open Policy Agent)  
   - Интеграция с SIEM для мониторинга  
3. **Оптимизация производительности**:  
   - Кэширование решений о доступе  
   - Горизонтальное масштабирование API-шлюза  

---

#### **Кейс: Защита медицинских данных в Yandex Cloud**
1. **Проблема**:  
   - 10+ источников данных (EHR, IoT-датчики)  
   - Требования GDPR и 152-ФЗ  
2. **Решение**:  
   - Единый API-шлюз с проверкой токенов IAM  
   - Политики доступа на основе атрибутов (ABAC):  
     ```rego
     allow {
         input.method == "GET"
         input.user.role == "doctor"
         input.resource.type == "medical_record"
     }
     ```  
3. **Результат**:  
   - Снижение инцидентов доступа на 70%  
   - Упрощение аудита  

---

### **Ограничения модели**
- **Боттлнек**: Перегрузка центрального компонента (требует HA-настройки)  
- **Задержки**: Дополнительные проверки увеличивают latency  
- **Сложность миграции**: Интеграция legacy-систем требует адаптеров  

``` 
[Вывод]
  Модель "Песочные часы" идеальна для облаков, где нужно балансировать 
  между безопасностью и гибкостью. Ключ к успеху — правильный выбор 
  центрального протокола и его тщательная оптимизация.
```
