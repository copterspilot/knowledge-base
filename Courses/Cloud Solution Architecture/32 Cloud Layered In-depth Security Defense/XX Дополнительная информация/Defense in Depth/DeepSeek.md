### **Defense in Depth в облачных средах: определение и специфика**

---

#### **Определение термина**  
**Defense in Depth (многоуровневая защита)** — стратегия безопасности, предполагающая создание **независимых защитных слоев**, где каждый уровень:  
- Компенсирует уязвимости других уровней  
- Увеличивает время и стоимость атаки для злоумышленника  
- Обеспечивает "планы Б" при компрометации одного из компонентов  

**Специфика в облаках**:  
В отличие от традиционных ЦОД, где физическая безопасность — основа, в облаках акцент смещается на:  
- **Виртуальные границы** (VPC, IAM) вместо физических  
- **Автоматизированную защиту** (auto-remediation)  
- **Разделение ответственности** (модель shared security)  

---

#### **Пример реализации в Yandex Cloud**  

##### **1. Уровень данных**  
- **Шифрование**:  
  - **KMS (Key Management Service)** для ключей шифрования  
  - **Автоматическое шифрование** Object Storage и Managed Databases  
- **Контроль доступа**:  
  - IAM-роли с привязкой к сервисным аккаунтам  
  - **Пример**:  
    ```bash
    yc iam role create --name security-admin --description "Role for KMS management"
    ```

##### **2. Уровень приложений**  
- **WAF (Web Application Firewall)**:  
  - Защита от OWASP Top 10 (SQLi, XSS)  
  - Интеграция с Yandex Application Load Balancer  
- **Secret Management**:  
  - Хранение секретов в **Lockbox** (аналог AWS Secrets Manager)  

##### **3. Сетевой уровень**  
- **Сегментация**:  
  - Группы безопасности (аналоги AWS Security Groups)  
  - **Пример правила**:  
    ```bash
    yc vpc security-group create --name backend-sg --rule "direction=ingress,port=443,protocol=tcp,predefined=self_security_group"
    ```
- **DDoS-защита**:  
  - Встроенная защита для публичных сервисов (например, API Gateway)  

##### **4. Мониторинг и реагирование**  
- **Yandex Audit Trails**:  
  - Логирование всех управляющих вызовов API  
- **Security Operations Center (SOC)**:  
  - Интеграция с SIEM-системами через **Data Streams**  

##### **5. Физический уровень**  
- **Сертифицированные дата-центры**:  
  - ISO 27001, PCI DSS, ГОСТ Р 57580  

---

#### **Как это работает вместе? Пример сценария**  
**Атака**: Злоумышленник пытается получить доступ к данным в Object Storage.  

1. **Первый уровень (IAM)**:  
   - Попытка доступа без MFA отклонена.  

2. **Второй уровень (WAF)**:  
   - SQL-инъекция в API блокируется правилами OWASP.  

3. **Третий уровень (Шифрование)**:  
   - Даже при утечке данных без KMS они нечитаемы.  

4. **Четвертый уровень (Мониторинг)**:  
   - Audit Trails фиксирует подозрительную активность, SOC получает алерт.  

---

#### **Отличия от традиционных решений**  
| **Аспект**          | **Традиционная инфраструктура** | **Yandex Cloud**                |  
|---------------------|--------------------------------|--------------------------------|  
| **Границы**         | Физические фаерволы            | Виртуальные группы безопасности |  
| **Масштабирование** | Ручное обновление правил       | Автоматическое через Terraform  |  
| **Соответствие**    | Дорогие аудиты                 | Встроенные compliance-шаблоны  |  

---

#### **Best Practices для Yandex Cloud**  
1. **Включить Audit Trails** для всех сервисов.  
2. **Использовать Managed KMS** вместо собственных решений.  
3. **Настроить квоты** через Organization Manager для предотвращения злоупотреблений.  
4. **Регулярно тестировать** безопасность через **Yandex Security Command Center**.  

``` 
[Ключевой принцип]
  В облаке Defense in Depth — это не "стена", а "матрешка", где каждый слой дублирует и усиливает предыдущий.
```

**Итог**: В Yandex Cloud многоуровневая защита реализуется через **нативные сервисы** + **интеграцию с экосистемой**, что снижает TCO на 30-40% по сравнению с self-hosted решениями.