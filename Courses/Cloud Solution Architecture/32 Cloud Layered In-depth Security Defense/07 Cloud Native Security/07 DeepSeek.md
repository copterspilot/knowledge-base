### **Cloud Native Security**  

**Описание:**  
Cloud Native Security — это комплекс мер, направленных на защиту облачных приложений и инфраструктуры на всех уровнях: от базовой инфраструктуры до прикладного ПО. Включает в себя безопасность контейнеров, Kubernetes, серверных и бессерверных технологий, а также соответствие лучшим практикам облачных провайдеров.  

---

## **1. Cloud Landing Zone: Cloud Infra**  
**Описание:** Безопасность облачной инфраструктуры начинается с правильно настроенного Landing Zone — базовой конфигурации аккаунта, включающей IAM, сетевую безопасность, логирование и автоматическое исправление уязвимостей.  

### **Тезисы и примеры нарушений:**  
- **IAM (Identity and Access Management)**  
  - **Нарушение:** Слишком широкие права пользователей (например, `*:*` в политике AWS IAM).  
  - **Пример:** В 2022 году утечка данных в компании Codecov произошла из-за чрезмерных прав CI/CD-пользователя, который смог изменять скрипты сборки.  
  - **Последствия:** Компрометация всей облачной среды, утечка данных, финансовые потери.  

- **Network Security (VPC, Security Groups, NACLs)**  
  - **Нарушение:** Открытый SSH/RDP доступ с `0.0.0.0/0`.  
  - **Пример:** В 2021 году атака на серверы Microsoft Exchange (ProxyLogon) использовала открытые RDP-порты.  
  - **Последствия:** Взлом серверов, криптоджекинг, утечка данных.  

- **Logging/Monitoring + SIEM**  
  - **Нарушение:** Отсутствие логирования действий в AWS CloudTrail.  
  - **Пример:** Взлом аккаунта AWS Capital One (2019) оставался незамеченным несколько месяцев из-за отключенного мониторинга.  
  - **Последствия:** Долгосрочная компрометация, утечка 100 млн записей клиентов.  

- **Auto-Remediation**  
  - **Нарушение:** Отсутствие автоматического отключения утерянных ключей.  
  - **Пример:** Утечка данных в Verizon (2017) из-за неотозванных ключей S3.  
  - **Решение:** AWS Config + Lambda для автоматического отзыва прав.  

---

## **2. Kubernetes (Managed Master + PODs + 3PP)**  
**Описание:** Защита кластера Kubernetes включает безопасность control plane, подов и сторонних плагинов.  

### **Тезисы и примеры нарушений:**  
- **Уязвимость в kube-apiserver**  
  - **Нарушение:** CVE-2018-1002105 — несанкционированный доступ к API.  
  - **Пример:** Tesla в 2018 году подверглась криптоджекингу из-за открытого Kubernetes Dashboard.  
  - **Последствия:** Майнинг криптовалюты на нодах, остановка сервисов.  

- **Небезопасные поды (Pods)**  
  - **Нарушение:** Запуск подов с `privileged: true`.  
  - **Пример:** Взлом кластера Shopify (2020) через уязвимый контейнер.  
  - **Решение:** Pod Security Policies (PSP) / OPA Gatekeeper.  

- **Уязвимости в сторонних плагинах (3PP)**  
  - **Нарушение:** Компрометация Helm-чартов или Istio.  
  - **Пример:** Атака на Weave Scope (CVE-2019-5736).  
  - **Последствия:** Escalation привилегий до уровня ноды.  

---

## **3. Host (EC2 Amazon Linux v2)**  
**Описание:** Безопасность виртуальных машин включает обновления ОС, минимальные права, защиту от несанкционированного доступа.  

### **Тезисы и примеры нарушений:**  
- **Необновленное ПО**  
  - **Нарушение:** Эксплуатация Log4Shell (CVE-2021-44228) на старых версиях Java.  
  - **Пример:** Взлом серверов VMware в 2021 году.  
  - **Решение:** AWS Systems Manager для автоматических патчей.  

- **SSH-ключи в открытом доступе**  
  - **Нарушение:** Публикация приватных ключей в GitHub.  
  - **Пример:** Компрометация серверов Uber (2016).  
  - **Последствия:** Полный контроль над инстансами.  

---

## **4. Docker Engine (configuration hardening)**  
**Описание:** Жесткая настройка Docker снижает риски breakout-атак.  

### **Тезисы и примеры нарушений:**  
- **Docker без AppArmor/SELinux**  
  - **Нарушение:** CVE-2019-5736 (escape из контейнера).  
  - **Пример:** Атака на серверы Alibaba Cloud (2020).  
  - **Решение:** `--security-opt="no-new-privileges"`.  

- **Небезопасные volume-монтирования**  
  - **Нарушение:** Монтирование `/var/run/docker.sock`.  
  - **Пример:** Взлом Docker-хоста через Jenkins-агента.  

---

## **5. App Stack (Node.js REST API Back-end)**  
**Описание:** Защита приложений включает контроль зависимостей, валидацию входных данных и безопасные настройки.  

### **Тезисы и примеры нарушений:**  
- **Уязвимые NPM-пакеты**  
  - **Нарушение:** `event-stream` (2018) с backdoor.  
  - **Последствия:** Кража биткоин-кошельков.  

- **SQL/NoSQL-инъекции**  
  - **Пример:** Утечка данных MongoDB (2020) из-за `{$ne: null}`-инъекций.  

---

## **6. Serverless (AWS Lambda, DynamoDB, API GW)**  
**Описание:** Риски бессерверных технологий — избыточные права, инъекции, неправильная логика авторизации.  

### **Тезисы и примеры нарушений:**  
- **Избыточные права Lambda**  
  - **Нарушение:** Функция с `dynamodb:*` вместо минимальных прав.  
  - **Пример:** Массовое удаление данных в DynamoDB (2021).  

- **Небезопасный API GW**  
  - **Нарушение:** Отсутствие WAF или rate-limiting.  
  - **Пример:** DDoS на сервис через API Gateway (2022).  

---

## **7. Другие облачные ресурсы (Cloud vendor’s best practices)**  
- **S3 Bucket Security** → Утечка данных в Accenture (2021) из-за публичного S3.  
- **RDS/IAM Database Authentication** → SQL-инъекции через скомпрометированные учетки.  

### **Вывод:**  
Cloud Native Security требует многоуровневой защиты. Нарушения на любом этапе приводят к катастрофическим последствиям — от утечек данных до полного взлома облачной инфраструктуры. Регулярный аудит и автоматизация исправлений критически важны.