# **Defense in Depth Network Security in Google Cloud**  

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞—â–∏—Ç—ã –≤ Google Cloud –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–µ **"Defense in Depth"**, –≥–¥–µ –∫–∞–∂–¥—ã–π —Å–ª–æ–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∂–¥—ã–π —Å–ª–æ–π, –ø—Ä–∏–º–µ—Ä—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π –∏ —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.  

---

## **1. Micro-segment Access to Applications and Services**  
### **üîπ IAM (API-based Access)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **Google Cloud IAM** —Å –ø—Ä–∏–Ω—Ü–∏–ø–æ–º –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (PoLP).  
- –†–æ–ª–∏ (`roles/`) –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (`*`).  
- **Conditional IAM** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ IP –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–∏).  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –°–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∞—è —Ä–æ–ª—å `roles/editor` –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.  
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –í 2020 –≥–æ–¥—É –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º GCP —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç CI/CD.  
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `roles/viewer` –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–æ–ª–∏.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω—ã **–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏** (`gcloud org-policies`).  
‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∏–º–µ—é—Ç **–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞**.  
‚úÖ –í–∫–ª—é—á–µ–Ω **Audit Logging** (Cloud Audit Logs).  

---

### **üîπ Istio Security (Micro-segmentation based on HTTP/S ID)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **Authorization Policies** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ALLOW from namespace:prod`).  
- **mTLS** –¥–ª—è —Å–µ—Ä–≤–∏—Å-—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–∏—Ç–∏–∫ Istio ‚Üí Lateral Movement –º–µ–∂–¥—É –Ω–µ–π–º—Å–ø–µ–π—Å–∞–º–∏.  
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –í 2021 –≥–æ–¥—É –∞—Ç–∞–∫—É—é—â–∏–π –ø–µ—Ä–µ–º–µ—â–∞–ª—Å—è –º–µ–∂–¥—É –ø–æ–¥–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è —É—è–∑–≤–∏–º—ã–π –≤–µ–±-—Å–µ—Ä–≤–∏—Å.  
- **–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å **`STRICT` mTLS** –∏ **AuthorizationPolicy**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –í–∫–ª—é—á–µ–Ω **mTLS –≤ —Ä–µ–∂–∏–º–µ `STRICT`**.  
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã **AuthorizationPolicy** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.  

---

### **üîπ Firewalls per Service Account (Micro-segmentation for VM-based Apps)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **Firewall Rules** —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ **Service Account**, –∞ –Ω–µ IP.  
- –ü—Ä–∏–º–µ—Ä: `gcloud compute firewall-rules create allow-internal --service-account=backend-sa@...`.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –û—Ç–∫—Ä—ã—Ç—ã–π `0.0.0.0/0` –¥–ª—è SSH –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.  
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –í 2019 –≥–æ–¥—É –±–æ—Ç–Ω–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã –∏ –∑–∞—Ä–∞–∂–∞–ª VM.  
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Identity-Aware Proxy (IAP)** –¥–ª—è SSH.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –ù–µ—Ç –ø—Ä–∞–≤–∏–ª —Å `0.0.0.0/0` (–∫—Ä–æ–º–µ Cloud Load Balancer).  
‚úÖ Firewall Rules –∏—Å–ø–æ–ª—å–∑—É—é—Ç **—Ç–µ–≥–∏ –∏–ª–∏ Service Accounts**.  

---

### **üîπ GKE Network Policies (Micro-segmentation within GKE Cluster)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **NetworkPolicy** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É `frontend` –∏ `backend`).  
- **Calico/Cilium** –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ NetworkPolicy ‚Üí –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –ø–æ–¥–∞ –ø—Ä–∏–≤–µ–ª–∞ –∫ –¥–æ—Å—Ç—É–ø—É –∫–æ –≤—Å–µ–º.  
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –ú–∞–π–Ω–∏–Ω–≥ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-–∫–ª–∞—Å—Ç–µ—Ä–µ (2022).  
- **–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å **`network-policy`** –≤ GKE.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –í–∫–ª—é—á–µ–Ω **Network Policy Enforcement**.  
‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã **–∏–∑–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `deny-all` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).  

---

## **2. Secure Your VPC for Private Deployments**  
### **üîπ VPC Service Controls (Data Exfiltration Protection)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ **GCS, BigQuery, Cloud SQL** —Ç–æ–ª—å–∫–æ –∏–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö VPC.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ VPC SC ‚Üí —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—É–±–ª–∏—á–Ω—ã–π –±–∞–∫–µ—Ç.  
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –£—Ç–µ—á–∫–∞ PII-–¥–∞–Ω–Ω—ã—Ö (2021, —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è).  
- **–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–∏—Ç—å **VPC Service Controls**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã **–ø–µ—Ä–∏–º–µ—Ç—Ä—ã VPC SC** –¥–ª—è sensitive data.  
‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã **–∏—Å–∫–ª—é—á–µ–Ω–∏—è (Access Levels)**.  

---

### **üîπ VPC-level Firewalls (Secure VPC Boundaries)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **Hierarchical Firewall Policies** (–Ω–∞ —É—Ä–æ–≤–Ω–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏).  
- **Deny by default** –¥–ª—è –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –†–∞–∑—Ä–µ—à–µ–Ω `0.0.0.0/0` –¥–ª—è RDP ‚Üí ransomware-–∞—Ç–∞–∫–∞.  
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç–µ–≥–∏ –∏ Service Accounts**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ **"deny all ingress"** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.  

---

### **üîπ Outbound NAT Proxy (Egress without Public IP)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **Cloud NAT** –¥–ª—è –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –±–µ–∑ –ø—É–±–ª–∏—á–Ω—ã—Ö IP.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** VM —Å –ø—É–±–ª–∏—á–Ω—ã–º IP ‚Üí DDoS-–∞—Ç–∞–∫–∞ —Å GCP.  
- **–†–µ—à–µ–Ω–∏–µ:** **–¢–æ–ª—å–∫–æ Private IP + Cloud NAT**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –í—Å–µ VM –∏—Å–ø–æ–ª—å–∑—É—é—Ç **—Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ IP**.  

---

### **üîπ VPN & Interconnect (Private On-Prem Access)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **HA VPN** –∏–ª–∏ **Partner Interconnect**.  
- **Tunnel Encryption (IPsec/IKEv2)**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω **–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ VPN-—Ç—É–Ω–Ω–µ–ª–µ–π**.  

---

## **3. Secure Internet-Facing Apps**  
### **üîπ Global LB (Anycast + DDoS Protection)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **Cloud Load Balancer + Cloud Armor**.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ VM ‚Üí DDoS (2020, 500 Gbps).  
- **–†–µ—à–µ–Ω–∏–µ:** **Only LB ‚Üí Backend**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –í–∫–ª—é—á–µ–Ω **Cloud Armor** (WAF + Rate Limiting).  

---

### **üîπ TLS Everywhere**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **Google-managed certs** (–∏–ª–∏ Let's Encrypt).  
- **Strict Transport Security (HSTS)**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç **TLS 1.2+**.  

---

### **üîπ IAP (Identity-Aware Proxy)**  
**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**  
- **SSH/RDP —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ IAP**.  

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Ä—É—à–µ–Ω–∏—è:**  
- **–ù–∞—Ä—É—à–µ–Ω–∏–µ:** –ü—Ä—è–º–æ–π SSH ‚Üí –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è (2021).  
- **–†–µ—à–µ–Ω–∏–µ:** **–¢–æ–ª—å–∫–æ IAP + 2FA**.  

**–ß–µ–∫-–ª–∏—Å—Ç:**  
‚úÖ –í—Å–µ VM **–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –ø—Ä—è–º–æ–≥–æ SSH/RDP**.  

---

## **–ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ GCP**  
| –£—Ä–æ–≤–µ–Ω—å                  | –ü—Ä–æ–≤–µ—Ä–∫–∞                                                                 |
|--------------------------|--------------------------------------------------------------------------|
| **IAM**                  | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞, Conditional Access, Audit Logs                        |
| **Istio**                | mTLS=STRICT, AuthorizationPolicy                                        |
| **GKE**                  | NetworkPolicy, PodSecurityPolicy                                         |
| **VPC**                  | Service Controls, Private Google Access                                  |
| **Firewall**             | Deny-all ingress, Service Account-based rules                           |
| **Cloud Armor**          | WAF, Rate Limiting, DDoS Protection                                     |
| **TLS**                  | Google-managed certs, HSTS                                              |
| **IAP**                  | SSH/RDP —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ IAP                                                |

**–í—ã–≤–æ–¥:** Defense in Depth –≤ GCP —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ **–≤—Å–µ—Ö —Å–ª–æ–µ–≤** ‚Äî –æ—Ç IAM –¥–æ VPC SC. –ù–∞—Ä—É—à–µ–Ω–∏–µ –Ω–∞ –ª—é–±–æ–º —É—Ä–æ–≤–Ω–µ –≤–µ–¥–µ—Ç –∫ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã.