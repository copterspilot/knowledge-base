### **Сравнение AWS CIS Benchmark и Dome9 Best Practices в рамках Logging**

---

#### **1. Ключевые различия в подходах**

| **Аспект**               | **AWS CIS Benchmark**                                      | **Dome9 BP**                              |
|--------------------------|----------------------------------------------------------|------------------------------------------|
| **Методология**         | Рекомендации для ручной настройки                        | Автоматизированное управление жизненным циклом логов |
| **Частота мониторинга** | Разовые/периодические проверки                           | Непрерывный контроль (real-time)         |
| **Глубина анализа**     | Базовые требования к включению сервисов                  | Расширенный анализ паттернов и аномалий |

---

#### **2. Конкретные требования к логированию**

| **Контрольная точка**                     | **CIS Benchmark**                                      | **Dome9 BP**                                         |
|-------------------------------------------|-------------------------------------------------------|-----------------------------------------------------|
| **Активация CloudTrail**                 | Требует включения в всех регионах (раздел 2.1)       | Автоматически активирует при обнаружении новых регионов |
| **Централизованное хранение логов**      | Рекомендует S3-бакет с MFA Delete (раздел 2.2)       | Автоматически настраивает: <br>• Шифрование KMS<br>• Object Lock<br>• Репликацию между регионами |
| **Мониторинг изменений логов**           | Ручная проверка через AWS Config (раздел 2.3)        | Детектирует и блокирует:<br>• Отключение CloudTrail<br>• Изменения политик S3 |
| **Интеграция с SIEM**                    | Рекомендует ручную настройку Kinesis Firehose        | Автоматическая интеграция с:<br>• Splunk<br>• QRadar<br>• Sumo Logic |

---

#### **3. Техническая реализация**

**AWS CIS Benchmark:**
```bash
# Ручная проверка статуса CloudTrail (CIS 2.1)
aws cloudtrail describe-trails --query 'trailList[].IsMultiRegionTrail'

# Проверка шифрования логов (CIS 2.7)
aws cloudtrail get-trail-status --name [trail-name] --query 'KmsKeyId'
```
**Ограничения:**  
- Нет автоматического реагирования  
- Требует ручного исправления нарушений  

**Dome9 BP:**  
```python
# Автоматический workflow
if cloudtrail_stopped():
    restart_trail()
    alert_security_team()
    
if unencrypted_logs_detected():
    enable_kms_encryption()
```
**Преимущества:**  
- Автоматическое создание трейлов в новых регионах  
- Встроенные шаблоны для быстрого развертывания  

---

#### **4. Соответствие стандартам**

| **Требование**               | **CIS** | **Dome9** |
|------------------------------|---------|-----------|
| Хранение логов ≥90 дней      | ✅       | ✅ + настраиваемые политики |
| Защита от модификации логов  | ✅       | ✅ + immutable storage      |
| Анализ аномальной активности | ❌       | ✅ (ML-based)               |
| Автоматическое оповещение    | ❌       | ✅ (10+ каналов интеграции) |

---

#### **5. Практические кейсы**

**CIS Benchmark:**  
- Обнаружил отключенный CloudTrail в ap-southeast-1  
- Требовал ручного включения через консоль  

**Dome9 BP:**  
1. Автоматически включил трейл в новом регионе  
2. Настроил поток логов в Security Lake  
3. Отправил уведомление в Slack о событии  

---

#### **6. Рекомендации по выбору**

**Для базового соответствия:**  
- CIS + AWS Config Rules  
- Ручная настройка S3-бакетов для логов  

**Для enterprise-решения:**  
- Dome9 с возможностями:<br>• Кросс-аккаунтовый сбор логов<br>• Автоматическое реагирование<br>• Встроенные дашборды  

**Важно:**  
Dome9 сокращает время обнаружения инцидентов с 7 дней (при ручном анализе) до 15 минут.  

```
[Эволюция мониторинга]
  CIS: Логирование → Ручной анализ → Реагирование (дни)
  Dome9: Логирование → Автоанализ → Автоисправление (минуты)
```