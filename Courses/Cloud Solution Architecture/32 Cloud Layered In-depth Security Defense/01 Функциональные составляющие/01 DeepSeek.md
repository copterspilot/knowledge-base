### **Функциональные составляющие безопасности AWS**

---

## **1. Centralized Logging, Monitoring, SIEM/SOAR**  
**Назначение:** Централизованный сбор, анализ и реагирование на события безопасности.  

**Описание:**  
Объединяет логи инфраструктуры, приложений и сервисов AWS в единую систему для выявления угроз в режиме реального времени.  

**Ключевые функции:**  
- **Amazon CloudWatch Logs** – сбор логов  
- **AWS Security Hub** – агрегация событий  
- **Amazon Detective** – расследование инцидентов  
- **Интеграция с Splunk/SIEM** (через Kinesis Firehose)  

**Практическое значение:**  
- Позволяет обнаруживать атаки (DDoS, brute force)  
- Автоматизирует реагирование через SOAR-правила  
- Соответствует требованиям PCI DSS, ISO 27001  

**Роль в архитектуре:**  
Является "центральной нервной системой" безопасности, связывая все компоненты защиты.  

---

## **2. Security & Audit Trail**  
**Назначение:** Фиксация всех действий в облаке для аудита и расследований.  

**Описание:**  
Записывает кто, когда и какие действия совершал в AWS-аккаунте.  

**Ключевые функции:**  
- **AWS CloudTrail** – логирование API-вызовов  
- **AWS Config** – история изменений конфигураций  
- **S3 Object Lock** – защита логов от изменений  

**Практическое значение:**  
- Обнаружение подозрительной активности (например, отключение MFA)  
- Обязательно для compliance (GDPR, HIPAA)  

**Роль в архитектуре:**  
Создает "неизменяемый черный ящик" для посмертного анализа.  

---

## **3. App Stack Guardrails**  
**Назначение:** Автоматическое предотвращение небезопасных конфигураций.  

**Описание:**  
Политики, которые не позволяют развертывать ресурсы с уязвимыми настройками.  

**Ключевые функции:**  
- **AWS Organizations SCP** – запрет опасных действий  
- **AWS Control Tower** – предустановленные guardrails  
- **Service Control Policies** – ограничение по регионам/сервисам  

**Практическое значение:**  
- Блокирует создание публичных S3-бакетов  
- Останавливает инстансы без шифрования  

**Роль в архитектуре:**  
"Автопилот безопасности", предотвращающий человеческие ошибки.  

---

## **4. Infra & App Security Compliance**  
**Назначение:** Поддержание соответствия стандартам.  

**Описание:**  
Автоматизированные проверки на соответствие CIS, NIST, HIPAA.  

**Ключевые функции:**  
- **AWS Audit Manager** – подготовка к аудитам  
- **AWS Config Rules** – автоматические проверки  
- **Security Hub Compliance** – дашборды соответствия  

**Практическое значение:**  
- Сокращает время подготовки к аудиту на 70%  
- Автоматически исправляет нарушения  

**Роль в архитектуре:**  
"Комплаенс-доктор" непрерывно проверяющий здоровье системы.  

---

## **5. Data, Apps, Cloud Infra, Protection**  
**Назначение:** Комплексная защита всех слоев.  

**Описание:**  
Объединяет:  
- **Данные:** Macie, KMS  
- **Приложения:** WAF, Inspector  
- **Инфраструктура:** GuardDuty, IAM  

**Практическое значение:**  
- Защищает от современных угроз (APT, zero-day)  
- Соответствует Zero Trust модели  

**Роль в архитектуре:**  
"Бронежилет" для облачной среды.  

---

## **6. Dev-Sec-Ops Toolchain**  
**Назначение:** Встраивание безопасности в CI/CD.  

**Описание:**  
Инструменты для "Shift Left" безопасности:  
- **AWS CodePipeline** – проверки в пайплайне  
- **Amazon CodeGuru** – анализ кода  
- **ECR Image Scanning** – сканирование образов  

**Практическое значение:**  
- Находит уязвимости до продакшена  
- Сокращает затраты на исправление  

**Роль в архитектуре:**  
"Фильтр безопасности" в процессе разработки.  

---

## **7. Automated Operations & Maintenance**  
**Назначение:** Автоматизация рутинных задач.  

**Описание:**  
- **AWS Systems Manager** – патчинг  
- **Lambda для автоматизации** – реагирование  
- **EventBridge правила** – триггеры  

**Практическое значение:**  
- Исправляет 90% известных уязвимостей автономно  
- Снижает нагрузку на SOC  

**Роль в архитектуре:**  
"Автомеханик" для облака, работающий 24/7.  

---

### **Сравнительная таблица**

| Компонент               | Ключевой сервис       | Главное преимущество                  |
|-------------------------|-----------------------|---------------------------------------|
| Centralized Monitoring  | Security Hub          | Единое окно для всех угроз            |
| Audit Trail             | CloudTrail + Config   | Неизменяемая история изменений        |
| Guardrails              | Control Tower         | Предотвращение ошибок                 |
| Compliance              | Audit Manager         | Автоматическая подготовка к аудитам   |
| Protection              | GuardDuty + WAF       | Защита от современных атак            |
| DevSecOps               | CodeGuru              | Безопасность "из коробки" в CI/CD     |
| Automation              | Systems Manager       | Самовосстанавливающаяся инфраструктура|

**Вывод:**  
Данные компоненты образуют полный цикл безопасности AWS - от предотвращения до реагирования, соответствуя принципам Zero Trust и DevSecOps.

---
### **1. Чек-лист для аудита безопасности AWS**

| **Компонент**               | **Контрольные точки**                                                                 | **Статус** |
|-----------------------------|--------------------------------------------------------------------------------------|------------|
| **1. Centralized Monitoring** | • Включен AWS Security Hub с интеграцией GuardDuty/Inspector<br>• Логи CloudTrail доставляются в S3 с Object Lock<br>• Настроены алерты на критические события через EventBridge | ☐          |
| **2. Audit Trail**          | • CloudTrail включен во всех регионах<br>• AWS Config записывает историю изменений ресурсов<br>• Логи защищены от модификации (S3 MFA Delete) | ☐          |
| **3. App Stack Guardrails**  | • SCP блокируют создание ресурсов без тегов<br>• Control Tower guardrails активированы<br>• Запрещены публичные S3-бакеты через SCP | ☐          |
| **4. Compliance**           | • Security Hub показывает ≥95% соответствия CIS Benchmark<br>• Audit Manager подготовил отчет для ISO 27001<br>• Нет неустраненных findings в Inspector | ☐          |
| **5. Protection**           | • WAF с OWASP CRS защищает публичные API<br>• Все S3-бакеты с SSE-KMS<br>• GuardDuty не показывает активных threats | ☐          |
| **6. DevSecOps**           | • CodeBuild сканирует код на уязвимости<br>• ECR Image Scanning включен для всех репозиториев<br>• В пайплайнах есть этап security testing | ☐          |
| **7. Automation**           | • Systems Manager автоматически применяет патчи<br>• Lambda функции реагируют на GuardDuty findings<br>• Настроен автоматический rollback при аномалиях | ☐          |

---

### **2. Чек-лист для архитектора**

| **Этап проектирования** | **Ключевые решения**                                                                 |
|-------------------------|-------------------------------------------------------------------------------------|
| **1. Мониторинг**       | • Выбрать SIEM (Splunk/Sentinel) + Kinesis Data Firehose для логов<br>• Настроить кросс-аккаунтовый Security Hub |
| **2. Трассировка**      | • Активировать организационный CloudTrail с шифрованием<br>• Включить AWS Config для всех поддерживаемых ресурсов |
| **3. Ограничения**      | • Разработать SCP для запрета:<br> - EC2 в публичных подсетях<br> - IAM-ролей с \*:\*<br>• Развернуть Control Tower |
| **4. Соответствие**     | • Включить Security Hub стандарты CIS, PCI DSS<br>• Настроить автоматическое исправление через Config Rules |
| **5. Защита**           | • Развернуть WAF с Managed Rules + Shield Advanced<br>• Шифровать все данные (KMS + Macie)<br>• Сегментировать VPC (NACL + Security Groups) |
| **6. DevSecOps**        | • Встроить в CI/CD:<br> - Checkov для Terraform<br> - Trivy для контейнеров<br>• Использовать CodeArtifact для зависимостей |
| **7. Автоматизация**    | • Настроить EventBridge правила для:<br> - Автоматического изолирования скомпрометированных EC2<br> - Ротации ключей IAM |

---

### **3. Диаграмма архитектуры безопасности AWS**

```
[Внешние угрозы]
       │
       ▼
┌───────────────────────┐
│  Уровень защиты       │
│  • CloudFront + WAF   │
│  • Shield Advanced    │
└──────────┬────────────┘
           │
┌──────────▼────────────┐
│  Уровень приложений   │
│  • Cognito + IAM      │
│  • API Gateway (WAF)  │
└──────────┬────────────┘
           │
┌──────────▼────────────┐
│  Уровень данных       │
│  • S3 (Macie+KMS)     │
│  • RDS (TDE+KMS)      │
└──────────┬────────────┘
           │
┌──────────▼────────────┐
│  Уровень инфраструктуры │
│  • GuardDuty          │
│  • VPC Flow Logs      │
└──────────┬────────────┘
           │
┌──────────▼────────────┐
│  Центральный уровень  │
│  • Security Hub       │
│  • CloudTrail+Config  │
└───────────────────────┘
```

---

### **4. Матрица соответствия принципам AWS Well-Architected**

| **Принцип безопасности AWS** | **Соответствующие компоненты**                                                                 | **Метрики**                          |
|------------------------------|------------------------------------------------------------------------------------------------|---------------------------------------|
| **Идентификация**            | • IAM + Cognito<br>• Audit Trail                                                              | • 100% MFA для root/пользователей     |
| **Защита инфраструктуры**    | • Guardrails (SCP)<br>• Network Firewall                                                      | • 0 публичных S3-бакетов             |
| **Защита данных**            | • KMS + Macie<br>• WAF + Shield                                                               | • 100% шифрование EBS/S3             |
| **Обнаружение**              | • GuardDuty + Security Hub<br>• Centralized Logging                                           | • Время обнаружения угроз <5 минут    |
| **Реагирование**             | • Automated Operations<br>• SOAR через Lambda+EventBridge                                     | • Время реагирования <15 минут       |
| **Восстановление**           | • Backup + Disaster Recovery<br>• Immutable Audit Logs                                        | • RPO ≤15 мин, RTO ≤1 час            |

**Ключевые показатели:**
- **Проактивность:** ≥95% нарушений блокируются guardrails
- **Видимость:** 100% ресурсов отслеживаются Config
- **Автоматизация:** 80% инцидентов обрабатываются без человека

Эта структура обеспечивает сквозную безопасность в соответствии с моделью NIST CSF (Identify-Protect-Detect-Respond-Recover).

