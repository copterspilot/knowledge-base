# üîê **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

---

## üìã **–û–±—â–µ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ**

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | **JWT (JSON Web Token)** | **PASETO (Platform-Agnostic Security Tokens)** |
| :--- | :--- | :--- |
| **–ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è** | 2010 | 2018 |
| **–°—Ç–∞–Ω–¥–∞—Ä—Ç** | RFC 7519 | RFC 8417 |
| **–§–∏–ª–æ—Å–æ—Ñ–∏—è** | –ì–∏–±–∫–æ—Å—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å | –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
| **–ü–æ–¥—Ö–æ–¥** | –ú–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ –æ–ø—Ü–∏–π | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –≤–µ—Ä—Å–∏–π |
| **–°—Ç—Ä—É–∫—Ç—É—Ä–∞** | `header.payload.signature` | `version.purpose.nonce.payload.footer` |
| **–ê–ª–≥–æ—Ä–∏—Ç–º—ã** | –ú–Ω–æ–∂–µ—Å—Ç–≤–æ (HS256, RS256, ES256 –∏ –¥—Ä.) | –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ (v1, v2, v3, v4) |
| **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** | –¢—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (JWE) | –í—Å—Ç—Ä–æ–µ–Ω–æ (local tokens) |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫ |
| **–£—è–∑–≤–∏–º–æ—Å—Ç–∏** | Algorithm Confusion, weak signatures | –ú–∏–Ω–∏–º—É–º –≤–µ–∫—Ç–æ—Ä–æ–≤ –∞—Ç–∞–∫ |
| **–ì–∏–±–∫–æ—Å—Ç—å** | –í—ã—Å–æ–∫–∞—è (custom claims) | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã) |
| **–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞** | –®–∏—Ä–æ–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ | –ú–µ–Ω—å—à–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ |
| **–†–∞–∑–º–µ—Ä —Ç–æ–∫–µ–Ω–∞** | –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π | –ë–æ–ª—å—à–µ (–∏–∑-–∑–∞ nonce –∏ –≤–µ—Ä—Å–∏–π) |
| **–û—Ç–ª–∞–¥–∫–∞** | –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π (base64) | –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω (–±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç) |
| **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, –≥–∏–±–∫–æ—Å—Ç—å –≤ claims | –ù–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
| **–ö–æ–≥–¥–∞ –∏–∑–±–µ–≥–∞—Ç—å** | –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å legacy —Å–∏—Å—Ç–µ–º–∞–º–∏ |

---

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**

### **JWT (JSON Web Token):**
```json
{
  "header": {
    "alg": "HS256",
    "typ": "JWT"
  },
  "payload": {
    "sub": "1234567890",
    "name": "John Doe",
    "iat": 1516239022
  },
  "signature": "HMACSHA256(...)"
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
‚úÖ –®–∏—Ä–æ–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞  
‚úÖ –ì–∏–±–∫–æ—Å—Ç—å –≤ –≤—ã–±–æ—Ä–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤  
‚úÖ –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ claims  

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
‚ùå –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
‚ùå –ê–ª–≥–æ—Ä–∏—Ç–º confusion attacks  
‚ùå –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏  

### **PASETO:**
```
v4.local.AAAAAAAAAAAAAAAA...
```

**–í–µ—Ä—Å–∏–∏:**
- **v1**: RSASSA-PKCS1-v1_5 + AES-CTR + HMAC-SHA384
- **v2**: EdDSA + XChaCha20-Poly1305
- **v3**: RSASSA-PSS + AES-256-CTR + HMAC-SHA384
- **v4**: Ed25519 + XChaCha20-Poly1305

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫  
‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
‚úÖ –ù–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º confusion  
‚úÖ –õ—É—á—à–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è  

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
‚ùå –ú–µ–Ω—å—à–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏  
‚ùå –ú–µ–Ω—å—à–µ –≥–∏–±–∫–æ—Å—Ç–∏  
‚ùå –ù–æ–≤–∏–∑–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞  

---

## ‚öîÔ∏è **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

### **JWT —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**
```mermaid
graph TD
    A[JWT Security Issues] --> B[Algorithm Confusion]
    A --> C[Weak Signature Algorithms]
    A --> D[Improper Validation]
    A --> E[Token Theft]
    
    B --> B1[None algorithm attack]
    B --> B2[RS256/HS256 confusion]
    
    C --> C1[Using none algorithm]
    C --> C2[Weak HMAC secrets]
    
    style A fill:#ffebee
    style B,C,D,E fill:#ffcdd2
    style B1,B2,C1,C2 fill:#ffebee
```

### **PASETO –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
```mermaid
graph TD
    A[PASETO Security] --> B[Versioned Approach]
    A --> C[Built-in Encryption]
    A --> D[Simplified Validation]
    A --> E[Modern Cryptography]
    
    B --> B1[No algorithm negotiation]
    B --> B2[Fixed algorithm per version]
    
    C --> C1[Local tokens encrypted]
    C --> C2[Public tokens signed]
    
    style A fill:#e8f5e8
    style B,C,D,E fill:#c8e6c9
    style B1,B2,C1,C2 fill:#e8f5e8
```

---

## üõ°Ô∏è **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**

### **JWT Implementation:**
```javascript
// Node.js JWT Example
const jwt = require('jsonwebtoken');

// –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
const token = jwt.sign(
  { userId: 123, role: 'user' },
  process.env.JWT_SECRET,
  { expiresIn: '1h', algorithm: 'HS256' }
);

// –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
try {
  const decoded = jwt.verify(token, process.env.JWT_SECRET);
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ claims –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
} catch (error) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
}
```

### **PASETO Implementation:**
```javascript
// Node.js PASETO Example
const { V4 } = require('paseto');

// –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
const token = await V4.encrypt(
  { userId: 123, role: 'user' },
  Buffer.from(process.env.PASETO_KEY, 'hex')
);

// –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
try {
  const decoded = await V4.decrypt(
    token,
    Buffer.from(process.env.PASETO_KEY, 'hex')
  );
} catch (error) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
}
```

---

## üìä **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

### **JWT:**
‚úÖ **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å JWT –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–∏–±–∫–æ—Å—Ç—å –≤ claims
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å third-party —Å–µ—Ä–≤–∏—Å–∞–º–∏

‚ùå **–ö–æ–≥–¥–∞ –∏–∑–±–µ–≥–∞—Ç—å:**
- –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ù–µ—Ç –æ–ø—ã—Ç–∞ –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### **PASETO:**
‚úÖ **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ù–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∑–∞—â–∏—Ç–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞–∂–Ω–∞

‚ùå **–ö–æ–≥–¥–∞ –∏–∑–±–µ–≥–∞—Ç—å:**
- –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å legacy —Å–∏—Å—Ç–µ–º–∞–º–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫

---

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è System Design**

### **–í—ã–±–æ—Ä JWT, –µ—Å–ª–∏:**
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ OAuth2/OpenID Connect –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ custom claims
- –ö–æ–º–∞–Ω–¥–∞ –∏–º–µ–µ—Ç –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å JWT

### **–í—ã–±–æ—Ä PASETO, –µ—Å–ª–∏:**
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –Ω—É–ª—è
- –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ñ–∏–Ω–∞–Ω—Å—ã, –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ)
- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
```yaml
security_considerations:
  jwt:
    - Use only HS256 or RS256
    - Implement proper token validation
    - Use short expiration times
    - Implement refresh token rotation
  
  paseto:
    - Use v4 for new implementations
    - Proper key management
    - Implement token blacklisting if needed
```

---

## üîö **–í—ã–≤–æ–¥**

**JWT** - –∑—Ä–µ–ª—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç —Å —à–∏—Ä–æ–∫–æ–π —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**PASETO** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é, –Ω–æ –º–µ–Ω—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç—å—é  

–í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç:
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –û–ø—ã—Ç–∞ –∫–æ–º–∞–Ω–¥—ã
- –°—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Ü–µ–ª–µ–π —Å–∏—Å—Ç–µ–º—ã

–û–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —á–∞—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
