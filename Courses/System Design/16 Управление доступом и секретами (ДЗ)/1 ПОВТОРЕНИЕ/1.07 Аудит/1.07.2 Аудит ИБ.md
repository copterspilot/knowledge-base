### **1. Аудит на уровне приложений (Application-Level Audit)**

**Примеры:**
- **Логирование действий пользователей:** Запись всех критичных операций (вход в систему, изменение данных, доступ к конфиденциальной информации) с указанием `user_id`, времени, IP-адреса.
- **Аудит бизнес-процессов:** Логирование ключевых этапов, например, в системе платежей - создание транзакции, подтверждение, отмена.
- **Логи API-вызовов:** Запись всех запросов к API с параметрами, результатами и кодами ответов.

**Инструменты:**
- Встроенные механизмы логирования фреймворков (например, `ILogger` в .NET, logback в Java).
- Структурированные логи в формате JSON для последующего анализа (ELK Stack, Loki).

### **2. Аудит на уровне систем безопасности (Security-Level Audit)**

**Примеры:**
- **Аудит аутентификации/авторизации:** Логирование успешных/неудачных попыток входа, использования токенов, проверки ролей.
- **Аудит доступа к файлам/ресурсам:** Запись попыток доступа к чувствительным файлам или каталогам (успех/отказ, кто пытался получить доступ).
- **Аудит изменений конфигурации:** Логирование изменений в критичных настройках системы.

**Инструменты:**
- **HashiCorp Vault Audit Backend:** Vault может логировать все запросы и ответы (чтение/запись секретов, аутентификация). Примеры backends: File, Syslog, Socket.
    ```bash
    # Включение аудита в Vault
    vault audit enable file file_path=/var/log/vault_audit.log
    ```
- **Системы SIEM (Security Information and Event Management):** Splunk, IBM QRadar, ELK Stack с SIEM-функциями. Собирают и коррелируют логи безопасности из множества источников.

### **3. Аудит на уровне инфраструктуры и платформ**

**Примеры:**
- **Аудит вызовов API облачных провайдеров:** Логирование всех действий с ресурсами (создание/удаление VM, изменение политик безопасности) в AWS CloudTrail, Google Cloud Audit Logs, Yandex Cloud Audit Trails.
- **Аудит в Kubernetes:** Логирование событий кластера (создание Pod'ов, доступ к Secrets) через `kubectl describe`, логи control plane, интеграция с внешними системами мониторинга.
- **Аудит сетевой активности:** Логирование сетевых подключений и передачи данных средствами брандмауэров или специализированных решений (например, AWS VPC Flow Logs).

**Инструменты:**
- Встроенные средства облачных платформ (CloudTrail, Audit Logs).
- Инструменты мониторинга и логирования (Prometheus, Grafana, Loki).
- OpenTelemetry для сбора телеметрии, которая затем может быть использована для аудита.

### **4. Аудит на уровне баз данных (Database Audit)**

**Примеры:**
- **Логирование запросов:** Запись всех (или критичных) SQL-запросов, выполненных к базе данных, особенно тех, что затрагивают чувствительные таблицы.
- **Аудит доступа:** Логирование подключений к БД, использования учетных записей.
- **Аудит изменений схемы:** Логирование DDL-операций (CREATE, ALTER, DROP).

**Инструменты:**
- Встроенные средства аудита СУБД (например, `pgAudit` для PostgreSQL, Audit Logs в MySQL, SQL Server Audit).
- Специализированные решения (Data Access Governance, Database Activity Monitoring).

### **5. Централизованный аудит и анализ**

**Примеры:**
- **Корреляция событий:** Связывание логов из разных источников (приложение, Vault, Kubernetes, СУБД, сеть) для выявления сложных инцидентов.
- **Алертинг:** Настройка уведомлений при обнаружении подозрительной активности (например, множественные неудачные попытки входа).
- **Долгосрочное хранение:** Архивирование логов аудита для соблюдения нормативных требований и расследований.

**Инструменты:**
- **SIEM-системы:** Splunk, IBM QRadar, ELK Stack (Elasticsearch + Logstash + Kibana).
- **Системы управления журналами:** Graylog.
- **Платформы наблюдаемости:** Grafana Loki для логов, Tempo для трассировок, Prometheus для метрик, которые могут быть интегрированы для комплексного аудита.

Эти варианты аудита являются важной частью проектирования безопасных систем, позволяя отслеживать события, выявлять аномалии, расследовать инциденты и обеспечивать соответствие требованиям.