## üîê **HSTS (HTTP Strict Transport Security) –∏ PFS (Perfect Forward Secrecy)**

---

## üîí **HSTS (HTTP Strict Transport Security)**

### **–ß—Ç–æ —ç—Ç–æ:**
**HSTS** - —ç—Ç–æ **–ø–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—É—é –≤–µ–±-—Å–∞–π—Ç—ã –ø–µ—Ä–µ–¥–∞—é—Ç –±—Ä–∞—É–∑–µ—Ä–∞–º —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π **HTTP –∑–∞–≥–æ–ª–æ–≤–æ–∫**. –≠—Ç–∞ –ø–æ–ª–∏—Ç–∏–∫–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É **–≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS** –ø—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ —Å –¥–∞–Ω–Ω—ã–º —Å–∞–π—Ç–æ–º –≤ —Ç–µ—á–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

### **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
```http
Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
```

1. **–ü–µ—Ä–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** - –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ HSTS
2. **–ë—Ä–∞—É–∑–µ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç** –ø–æ–ª–∏—Ç–∏–∫—É –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è (max-age)
3. **–ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** - –±—Ä–∞—É–∑–µ—Ä **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTTPS**, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª `http://`

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç SSL Stripping –∞—Ç–∞–∫**  
‚úÖ **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ MITM** —á–µ—Ä–µ–∑ HTTP  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏—è** –Ω–∞ HTTPS  
‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max-age` - –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- `includeSubDomains` - –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫–æ –≤—Å–µ–º –ø–æ–¥–¥–æ–º–µ–Ω–∞–º
- `preload` - –≤–∫–ª—é—á–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫ HSTS preload –±—Ä–∞—É–∑–µ—Ä–æ–≤

---

## üõ°Ô∏è **PFS (Perfect Forward Secrecy)**

### **–ß—Ç–æ —ç—Ç–æ:**
**PFS** - —ç—Ç–æ **—Å–≤–æ–π—Å—Ç–≤–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤**, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–µ **–∑–∞—â–∏—Ç—É –ø—Ä–æ—à–ª—ã—Ö —Å–µ—Å—Å–∏–π** –¥–∞–∂–µ –≤ —Å–ª—É—á–∞–µ **–∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏** –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ —Å–µ—Ä–≤–µ—Ä–∞.

### **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **—ç—Ñ–µ–º–µ—Ä–Ω—ã–µ (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ) –∫–ª—é—á–∏** –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏
- **–î–∏—Ñ—Ñ–∏-–•–µ–ª–ª–º–∞–Ω** —Å —ç—Ñ–µ–º–µ—Ä–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ (DHE/ECDHE)
- **–ì–ª–∞–≤–Ω–æ–µ**: –≥–ª–∞–≤–Ω—ã–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–∏

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
‚úÖ **–ó–∞—â–∏—Ç–∞ –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**  
‚úÖ **–°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–µ–π**  
‚úÖ **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤ –±—É–¥—É—â–µ–º**  
‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

### **–ü—Ä–∏–º–µ—Ä handshake —Å PFS:**
```mermaid
sequenceDiagram
    participant Client
    participant Server

    Client->>Server: Client Hello (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ cipher suites)
    Server->>Client: Server Hello (–≤—ã–±—Ä–∞–Ω–Ω—ã–π cipher suite —Å ECDHE)
    Server->>Client: Certificate
    Server->>Client: Server Key Exchange (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã ECDHE)
    Server->>Client: Server Hello Done
    Client->>Server: Client Key Exchange (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã ECDHE)
    Client->>Server: Change Cipher Spec
    Client->>Server: Finished
    Server->>Client: Change Cipher Spec
    Server->>Client: Finished
```

---

## ‚öîÔ∏è **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ HSTS –∏ PFS**

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | **HSTS** | **PFS** |
|----------------|----------|---------|
| **–£—Ä–æ–≤–µ–Ω—å** | Application (HTTP) | Transport (TLS) |
| **–¶–µ–ª—å** | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS | –ó–∞—â–∏—Ç–∞ –∫–ª—é—á–µ–π —Å–µ—Å—Å–∏–∏ |
| **–ó–∞—â–∏—Ç–∞ –æ—Ç** | SSL Stripping, downgrade –∞—Ç–∞–∫ | –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –ø—Ä–æ—à–ª—ã—Ö —Å–µ—Å—Å–∏–π |
| **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è** | HTTP –∑–∞–≥–æ–ª–æ–≤–æ–∫ | Cipher suites (ECDHE) |
| **–í—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è** | –£–∫–∞–∑–∞–Ω–Ω–æ–µ –≤ max-age | –û–¥–Ω–∞ —Å–µ—Å—Å–∏—è |

---

## üéØ **–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

### **Nginx —Å HSTS –∏ PFS:**
```nginx
server {
    listen 443 ssl http2;
    server_name example.com;
    
    # SSL —Å PFS
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256;
    ssl_prefer_server_ciphers off;
    
    # HSTS
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
    
    # –î—Ä—É–≥–∏–µ security headers
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
}
```

### **Apache:**
```apache
<VirtualHost *:443>
    # SSL —Å PFS
    SSLEngine on
    SSLCertificateFile /path/to/cert.pem
    SSLCertificateKeyFile /path/to/key.pem
    SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
    SSLCipherSuite ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256
    
    # HSTS
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
</VirtualHost>
```

---

## üìä **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ HSTS:**
```bash
# –ß–µ—Ä–µ–∑ curl
curl -I https://example.com | grep -i strict

# –ß–µ—Ä–µ–∑ –æ–Ω–ª–∞–π–Ω —Å–µ—Ä–≤–∏—Å—ã
https://hstspreload.org/
https://securityheaders.com/
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ PFS:**
```bash
# SSL Labs —Ç–µ—Å—Ç
https://www.ssllabs.com/ssltest/

# OpenSSL
openssl ciphers -V 'ALL:COMPLEMENTOFALL' | grep -i dhe
```

---

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**

### **–î–ª—è HSTS:**
- ‚ö†Ô∏è **–ù–µ–ª—å–∑—è –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è** –Ω–∞ HTTP –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è
- ‚ö†Ô∏è **–û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å preload** - —Å–ª–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–æ–≤
- ‚úÖ **–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –º–∞–ª–æ–≥–æ max-age** –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

### **–î–ª—è PFS:**
- ‚ö†Ô∏è **–ë–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏** —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
- ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

**HSTS –∏ PFS** - —ç—Ç–æ **–≤–∞–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –≤–µ–±-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** –∏ **–∑–∞—â–∏—Ç—É –∫–ª—é—á–µ–π** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ!

