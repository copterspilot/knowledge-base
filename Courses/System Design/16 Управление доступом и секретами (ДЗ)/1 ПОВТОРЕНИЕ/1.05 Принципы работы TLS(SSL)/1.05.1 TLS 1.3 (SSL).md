```plantuml
@startuml
title TLS 1.3 Handshake (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π)

actor "–ö–ª–∏–µ–Ω—Ç" as Client
participant "–ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ\n–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" as ClientApp
participant "–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π\nTLS Stack" as ClientTLS
participant "–°–µ—Ä–≤–µ—Ä–Ω—ã–π\nTLS Stack" as ServerTLS
participant "–°–µ—Ä–≤–µ—Ä–Ω–æ–µ\n–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" as ServerApp
actor "–°–µ—Ä–≤–µ—Ä" as Server

Client -> ClientApp: 1. –ó–∞–ø—Ä–æ—Å HTTPS\n(–Ω–∞–ø—Ä–∏–º–µ—Ä, GET /)
ClientApp -> ClientTLS: 2. –ù–∞—á–∞–ª–æ TLS Handshake
ClientTLS -> ServerTLS: 3. Client Hello\n(–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏ TLS,\ncipher suites, extensions)
ServerTLS -> ServerTLS: 4. –í—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤\n(–≤–µ—Ä—Å–∏—è, cipher suite)
ServerTLS -> ClientTLS: 5. Server Hello\n(–í—ã–±—Ä–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –∏ cipher suite,\nServer Random)
ServerTLS -> ClientTLS: 6. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ Extensions\n(Encrypted Extensions)
ServerTLS -> ClientTLS: 7. Certificate Message\n(–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞)
ServerTLS -> ClientTLS: 8. Certificate Verify\n(–ü–æ–¥–ø–∏—Å—å –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è\n–≤–ª–∞–¥–µ–Ω–∏—è –∑–∞–∫—Ä—ã—Ç—ã–º –∫–ª—é—á–æ–º)
ServerTLS -> ClientTLS: 9. Server Finished\n(–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ handshake)
ClientTLS -> ClientTLS: 10. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞\n–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π
ClientTLS -> ServerTLS: 11. Client Finished\n(–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ handshake)
ClientTLS <-> ServerTLS: 12. –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n(Application Data)
ClientTLS -> ClientApp: 13. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö\n–ø–æ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É –∫–∞–Ω–∞–ª—É
ServerTLS -> ServerApp: 14. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö\n–ø–æ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É –∫–∞–Ω–∞–ª—É

@enduml
```

```
–í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ TLS 1.3:
- –£—Å–∫–æ—Ä–µ–Ω–Ω—ã–π handshake (1 RTT)
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π PFS —á–µ—Ä–µ–∑ (EC)DHE
- –ó–∞—â–∏—Ç–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö handshake
- 0-RTT –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

–≠—Ç–∞ –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å TLS 1.3 handshake, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** (–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å)
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —Å–µ—Ä–≤–µ—Ä–∞** (–ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å)
- **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** (–Ω–µ–∏–∑–º–µ–Ω–Ω–æ—Å—Ç—å)
- **Perfect Forward Secrecy** (PFS) —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏

---

## üîê **–ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã TLS/SSL**

### **–ß—Ç–æ —Ç–∞–∫–æ–µ TLS/SSL:**
**TLS (Transport Layer Security)** –∏ –µ–≥–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏–π predecessor **SSL (Secure Sockets Layer)** - —ç—Ç–æ **–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è **–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö**, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –ø–æ —Å–µ—Ç–∏. –û–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç:
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** (–∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å)
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é** (–ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å —Å—Ç–æ—Ä–æ–Ω)
- **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å** (–Ω–µ–∏–∑–º–µ–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö)

### **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç TLS Handshake (—É–ø—Ä–æ—â–µ–Ω–Ω–æ):**

1.  **Client Hello:** –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –≤–µ—Ä—Å–∏–π TLS, cipher suites (–Ω–∞–±–æ—Ä–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è) –∏ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ.
2.  **Server Hello:** –°–µ—Ä–≤–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –≤–µ—Ä—Å–∏—é TLS –∏ cipher suite –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–µ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏, –≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞–ø—Ä–æ—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞.
3.  **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –æ–±–º–µ–Ω –∫–ª—é—á–∞–º–∏:**
    - –ö–ª–∏–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–¥–æ–≤–µ—Ä–∏–µ –∫ –¶–µ–Ω—Ç—Ä—É –í—ã–¥–∞—á–∏, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è, –∏–º—è —Ö–æ—Å—Ç–∞).
    - –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ cipher suite, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–±–º–µ–Ω –∫–ª—é—á–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Diffie-Hellman) –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç —à–∏—Ñ—Ä—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–ª—é—á (pre-master secret) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ —Å–µ—Ä–≤–µ—Ä—É.
4.  **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:**
    - –û–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –≤—ã—á–∏—Å–ª—è—é—Ç —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∏–∑ –æ–±–º–µ–Ω—è–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    - –ö–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ `Finished`, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—è —É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ handshake.
5.  **–ó–∞—â–∏—â–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö:** –í—Å—è –¥–∞–ª—å–Ω–µ–π—à–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —à–∏—Ñ—Ä—É–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π.

### **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–ª–∏–µ–Ω—Ç–∞). –°–æ–¥–µ—Ä–∂–∞—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π –∫–ª—é—á –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–ª–∞–¥–µ–ª—å—Ü–µ, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –¶–µ–Ω—Ç—Ä–æ–º –í—ã–¥–∞—á–∏ (CA).
- **Cipher Suites:** –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –¥–ª—è –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256`).
- **–°–µ—Å—Å–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏:** –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ –∫–ª—é—á–∏, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.

---

## üõ°Ô∏è **–†–æ–ª—å PKCE, HSTS, PFS**

### **PKCE (Proof Key for Code Exchange):**
- **–†–æ–ª—å:** **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ OAuth 2.0**, —Å–æ–∑–¥–∞–Ω–Ω–æ–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –∑–∞—â–∏—Ç—ã **–ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤** (–º–æ–±–∏–ª—å–Ω—ã–µ –∏ –æ–¥–Ω–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è), –≥–¥–µ —Å–µ–∫—Ä–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞–¥–µ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ö–ª–∏–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π "–∫–ª—é—á" (`code_verifier`) –∏ –µ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é (`code_challenge`). `code_challenge` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ü—Ä–∏ –æ–±–º–µ–Ω–µ –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Ç–æ–∫–µ–Ω, –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `code_verifier`. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ `code_challenge`. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∞—Ç–∞–∫–∏, –≥–¥–µ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–π –∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–≥ –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º.
- **–ö—Ä–∞—Ç–∫–æ:** –ó–∞—â–∏—Ç–∞ –ø–æ—Ç–æ–∫–∞ OAuth 2.0 –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç —Å–∫—Ä—ã—Ç—å —Å–µ–∫—Ä–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞.

### **HSTS (HTTP Strict Transport Security):**
- **–†–æ–ª—å:** **–ü–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä—É—é –≤–µ–±-—Å–∞–π—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É —á–µ—Ä–µ–∑ HTTP-–∑–∞–≥–æ–ª–æ–≤–æ–∫, —É–∫–∞–∑—ã–≤–∞—è, —á—Ç–æ **–≤—Å–µ–≥–¥–∞** —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **HTTPS** –¥–ª—è —Å–≤—è–∑–∏ —Å —ç—Ç–∏–º —Å–∞–π—Ç–æ–º –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ HTTPS-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫—É HSTS. –ü—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö –¥–æ—Å—Ç—É–ø–∞ –ø–æ `http://` –±—Ä–∞—É–∑–µ—Ä **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –º–µ–Ω—è–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ `https://` –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.
- **–ö—Ä–∞—Ç–∫–æ:** –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS –±—Ä–∞—É–∑–µ—Ä–æ–º, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—â–µ–µ downgrade-–∞—Ç–∞–∫–∏ (SSL Stripping).

### **PFS (Perfect Forward Secrecy):**
- **–†–æ–ª—å:** **–°–≤–æ–π—Å—Ç–≤–æ** —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π –≤ TLS, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–µ **–∑–∞—â–∏—Ç—É –ø—Ä–æ—à–ª—ã—Ö —Å–µ—Å—Å–∏–π** –¥–∞–∂–µ –≤ —Å–ª—É—á–∞–µ **–∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏** –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –±—É–¥—É—â–µ–º.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** –í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∫–ª—é—á–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ RSA) –¥–ª—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **—ç—Ñ–µ–º–µ—Ä–Ω—ã–µ (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ) –∫–ª—é—á–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, ECDHE - Elliptic Curve Diffie-Hellman Ephemeral). –≠—Ç–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏ –∏ —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –Ω–µ–µ.
- **–ö—Ä–∞—Ç–∫–æ:** –ó–∞—â–∏—Ç–∞ –ø—Ä–æ—à–ª—ã—Ö —Å–µ—Å—Å–∏–π –æ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –≥–ª–∞–≤–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ –±—É–¥–µ—Ç —É–∫—Ä–∞–¥–µ–Ω –ø–æ–∑–∂–µ.

---

### **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**

1. **In-Transit (–ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ):** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ä–µ–º—è –∏—Ö –ø–µ—Ä–µ–¥–∞—á–∏ –ø–æ —Å–µ—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, TLS 1.3).
2. **At-Rest (–≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ):** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö, —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, –æ–±—ä–µ–∫—Ç–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, AES-256).
3. **Client-Side (–Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ):** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ –∏—Ö –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–∞–º–µ—Ç–æ–∫ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π).
4. **In-Use (–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏):** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Confidential Computing).
5. **Application-Layer (–Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è):** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª–µ–π –∏–ª–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –∏–ª–∏ –Ω–æ–º–µ—Ä–æ–≤ –∫–∞—Ä—Ç).
6. **Key Encryption (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π):** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–π –æ–±–µ—Ä—Ç–∫–∏ (Key Wrapping) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏.
7. **Post-Quantum (–ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–µ):** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∫ –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑—É —Å –ø–æ–º–æ—â—å—é –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ/–≥–∏–±—Ä–∏–¥–Ω–æ).

---

```plantuml
@startuml
title TLS 1.3 Handshake (–∫—Ä–∞—Ç–∫–æ)

actor "–ö–ª–∏–µ–Ω—Ç" as Client
participant "–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π\nTLS" as ClientTLS
participant "–°–µ—Ä–≤–µ—Ä–Ω—ã–π\nTLS" as ServerTLS
actor "–°–µ—Ä–≤–µ—Ä" as Server

ClientTLS -> ServerTLS: 1. Client Hello\n(–í–µ—Ä—Å–∏–∏ TLS, cipher suites)
ServerTLS -> ClientTLS: 2. Server Hello\n(–í—ã–±—Ä–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è/cipher suite)
ServerTLS -> ClientTLS: 3. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞
ServerTLS -> ClientTLS: 4. Server Finished\n(–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏)
ClientTLS -> ClientTLS: 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞\n–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π
ClientTLS -> ServerTLS: 6. Client Finished\n(–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏)
ClientTLS <-> ServerTLS: 7. –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n(–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)

@enduml
```

---

```mermaid
sequenceDiagram
    title TLS 1.3 Handshake (–∫—Ä–∞—Ç–∫–æ)

    participant –ö–ª–∏–µ–Ω—Ç
    participant –°–µ—Ä–≤–µ—Ä

    –ö–ª–∏–µ–Ω—Ç->>–°–µ—Ä–≤–µ—Ä: 1. Client Hello (–í–µ—Ä—Å–∏–∏ TLS, cipher suites)
    –°–µ—Ä–≤–µ—Ä->>–ö–ª–∏–µ–Ω—Ç: 2. Server Hello (–í—ã–±—Ä–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è/cipher suite)
    –°–µ—Ä–≤–µ—Ä->>–ö–ª–∏–µ–Ω—Ç: 3. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞
    –°–µ—Ä–≤–µ—Ä->>–ö–ª–∏–µ–Ω—Ç: 4. Server Finished (–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏)
    –ö–ª–∏–µ–Ω—Ç->>–ö–ª–∏–µ–Ω—Ç: 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π
    –ö–ª–∏–µ–Ω—Ç->>–°–µ—Ä–≤–µ—Ä: 6. Client Finished (–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏)
    –ö–ª–∏–µ–Ω—Ç-->>–°–µ—Ä–≤–µ—Ä: 7. –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)
```

---

```plantuml
@startuml
title mTLS - –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

actor "–ö–ª–∏–µ–Ω—Ç" as Client
participant "–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π\nmTLS" as ClientTLS
participant "–°–µ—Ä–≤–µ—Ä–Ω—ã–π\nmTLS" as ServerTLS
actor "–°–µ—Ä–≤–µ—Ä" as Server

ClientTLS -> ServerTLS: 1. Client Hello\n(–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ cipher suites)
ServerTLS -> ClientTLS: 2. Server Hello\n(–í—ã–±—Ä–∞–Ω–Ω—ã–π cipher suite)
ServerTLS -> ClientTLS: 3. Server Certificate\n(–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞)
ServerTLS -> ClientTLS: 4. Certificate Request\n(–ó–∞–ø—Ä–æ—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞)
ServerTLS -> ClientTLS: 5. Server Finished
ClientTLS -> ClientTLS: 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
ClientTLS -> ServerTLS: 7. Client Certificate\n(–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∫–ª–∏–µ–Ω—Ç–∞)
ClientTLS -> ServerTLS: 8. Client Certificate Verify\n(–ü–æ–¥–ø–∏—Å—å –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
ClientTLS -> ServerTLS: 9. Client Finished
ServerTLS -> ServerTLS: 10. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞
ClientTLS <-> ServerTLS: 11. –ó–∞—â–∏—â–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n(–í–∑–∞–∏–º–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)

@enduml
```

```
–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ mTLS:
- –í–∑–∞–∏–º–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ö–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è—é—Ç\n–¥—Ä—É–≥ –¥—Ä—É–≥–∞
- –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö\n–∏ API
```